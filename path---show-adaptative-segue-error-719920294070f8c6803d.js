webpackJsonp([0xb8524b07cad6],{552:function(e,o){e.exports={data:{site:{siteMetadata:{githubRepo:"https://github.com/esttorhe/esttorhe.github.io",author:"Esteban Torres"}},markdownRemark:{frontmatter:{title:"'Show' Adaptative Segue Error",issueNumber:33,categories:["bug","radar"],tags:["ios","radar","bug","segue"],author:"Esteban Torres",date:"2014-12-16 18:43:03 +0000"},html:'<p>{% github esttorhe ShowNotWorking_Radar 5f81558 %}</p>\n<p>On our projects we use multiple <code>UIStoryboard</code> files to break our apps; yes, we use storyboards, we are drinking Apple\'s "Kool-Aid" and personally they are real time savers and let us focus on improving the experience and enforcing the business rules.</p>\n<h1 id="fist-glimpse-of-the-problem"><a href="#fist-glimpse-of-the-problem" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fist Glimpse Of The Problem</h1>\n<p>Although this "embracing the change" would come to hunts us with a weird bug that was reported to us; hitting a "share" button was yielding no actions…</p>\n<p>That\'s weird since we have it "wired" to launch a <code>UIActivityController</code> that will handle our sharing list.</p>\n<p>Let\'s open <code>Xcode</code> and launch the simulator… nope, everything works as expected.</p>\n<p>Time to connect our device; load the latest build, run and… nope, can\'t reproduce.</p>\n<!-- more -->\n<h1 id="isolating-the-bug"><a href="#isolating-the-bug" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Isolating The Bug</h1>\n<p>After writing back to the reporter we got word that the issue is happening on an <code>iPhone</code> running <code>7.1</code>.</p>\n<p>With that we go to <code>Xcode</code>, rinse and repeat with the exception that this time there\'s nothing happening after hitting the share button.</p>\n<p>We immediately noticed that the <code>UINavigationBar</code> was missing from the "sharing" view controller and internally we were presenting the <code>UIActivityController</code> like this:</p>\n<pre><code class="language-objc">UIActivityViewController *activityViewController = [[UIActivityViewController alloc] initWithActivityItems:@[self.currentUser.myList.itemProvider] applicationActivities:nil];\n// Adding some exclusions, etc \n[self.navigationController presentViewController:activityViewController animated:YES completion:^{\n    // Do some other stuff\n}];\n</code></pre>\n<p>Just from looking at the code plus the lack of navigation bar we can infer that our <code>navigationController</code> property was <code>nil</code>.</p>\n<p>After debugging its confirmed; it is <code>nil</code>; but not just that; the child view controller is being presented <strong>modally</strong>… so… <code>iOS</code> somewhere is taking the child view controller out of its hierarchy and its presenting it completely isolated as a "modal" leaving the user stuck (because it was coded assuming a <code>Back</code> button on <code>UINavigationBar</code> added after the push).</p>\n<h1 id="but-why"><a href="#but-why" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>But <strong>WHY??</strong>…</h1>\n<p>I went to Apple\'s documentation regarding this new "adaptive segues" (because if you didn\'t know <code>Push</code>, <code>Modal</code>, <code>Popover</code> &#x26; <code>Replace</code> are now deprecated) and this is what I found:\n<img src="/2014-12-16-show-adaptative-segue-error/segues-table.png">\n<em>From Apple\'s Documentation: <a href="https://developer.apple.com/library/ios/recipes/xcode_help-IB_storyboard/chapters/StoryboardSegue.html">https://developer.apple.com/library/ios/recipes/xcode<em>help-IB</em>storyboard/chapters/StoryboardSegue.html</a></em></p>\n<p>From the documentation we can take that during a "regular" usage of the <code>Show</code> segue on an <code>iPhone</code> app that\'s not showing a master/detail the segue will behave as a now deprecated <code>Push</code> segue.</p>\n<p>To add to the weirdness everything works as expected on <code>iOS8</code> but it doesn\'t on <code>iOS7</code>.</p>\n<p>With that in mind I went to <code>Xcode</code> with the sole idea of generating a project that could easily reproduce the issue.</p>\n<p>New Project, open the storyboard; throw a <code>UINavigationController</code>; set its <code>rootViewController</code>, one <code>UIButton</code>, connect its action to <code>Show</code> and that to another <code>UIViewController</code>; now lets create some code for that child view controller that should display a <code>UIActivityController</code> upon <code>viewDidAppear:</code>:</p>\n<pre><code class="language-objc">- (void)viewDidAppear:(BOOL)animated {\n    [super viewDidAppear:animated];\n    \n    UIActivityViewController *activityVC = [[UIActivityViewController alloc] initWithActivityItems:@[@"Test"]\n                                                                             applicationActivities:nil];\n    [self.navigationController presentViewController:activityVC animated:YES completion:^{\n        NSLog(@"This line will never execute on iOS 7.1");\n    }];\n}\n</code></pre>\n<p>And voilà; compile and run on <code>iOS8</code>; everything works.</p>\n<p>Close, compile and run on <code>iOS7</code>… everything works.</p>\n<p><strong>YES</strong>… no wait… the code is working correctly on both environments. Cleaning and building again did not introduce the issue. </p>\n<h1 id="consistently-reproducing-the-bug"><a href="#consistently-reproducing-the-bug" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Consistently Reproducing The Bug</h1>\n<p>I was just about to give hope on this when I remembered something. In our project we have a "hamburger" menu (something for another post) which "replaces" the top view controller via code before using all the segues from the storyboard.</p>\n<p>Perhaps that\'s the issue; let\'s make a couple of modifications.</p>\n<p>First let\'s add an "extra" level on our storyboards; so that we now have something like this:</p>\n<pre><code>--- UINavigationController\n    --- Root View Controller\n    --- Pushed 1st View Controller // Via Code\n    --- Pushed 2nd View Controller // Via `Show` segue\n</code></pre>\n<p>And from the 1st view controller let\'s push the 2nd one with some boilerplate code:</p>\n<pre><code class="language-objc">UIViewController *vc = \n[self.storyboard instantiateViewControllerWithIdentifier:@"ViewController"];\n[self.navigationController pushViewController:vc animated:YES];\n</code></pre>\n<p>Compile and run on <code>iOS8</code> everything works</p>\n<p><img src="/2014-12-16-show-adaptative-segue-error/iOS8.png"></p>\n<p> close compile and run on <code>iOS7</code> and… there you go.\n<img src="/2014-12-16-show-adaptative-segue-error/iOS7.png"></p>\n<p>Last <code>UIViewController</code> is being presented modally instead of pushed to the current stack; thus, its <code>navigationController</code> property is <code>nil</code>.</p>\n<h1 id="conclusion"><a href="#conclusion" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h1>\n<p>This is obviously a bug introduced by Apple that does not support "retro compatiblity" of this new <code>adaptative segues</code>.</p>\n<p>We should be able to replace the deprecated <code>Push</code> with this <code>Show</code> and it should behave the same unless we are taking advantage of this whole new "master/detail" containers approach.</p>\n<p>I filed a <a href="http://www.openradar.me/19259764">radar</a> with this issue, please feel free to duplicate with that hopes that Apple fixes it.</p>\n<p>Also <a href="https://github.com/esttorhe/ShowNotWorking_Radar">here\'s the code</a> with a project that easily reproduces the issue.</p>\n<h1 id="workaround"><a href="#workaround" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Workaround</h1>\n<p>For now the only "solution" is changing the <code>Show</code> segue for a <code>Deprecated</code> <code>Push</code>; this looks like (and <strong><em>is</em></strong> ) code smell but its the only viable solution for now.</p>\n<h1 id="update"><a href="#update" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UPDATE</h1>\n<p>Recently I got an update on my radar from  with the following response:</p>\n<blockquote>\n<p>Adaptive segues like Show are only supported when running on iOS 8 or later. Interface Builder is failing to warn that this segue will not be properly unarchived on iOS 7.</p>\n<p>We are continuing to work on this issue, and will follow up with you again.</p>\n</blockquote>\n<p>So there you have it;  kind of accepted it as a bug (at least on IB not warning) but at the same time is telling us that pre <code>iOS8</code> adaptative segues could have unexpected behavior.</p>\n<p>Long story short; <em>DON\'T USE THEM</em> if you need to support older OS versions.</p>',url:"show-adaptative-segue-error"}},pathContext:{id:"/home/travis/build/esttorhe/esttorhe.github.io/content/_posts/2014-12-16-show-adaptative-segue-error/2014-12-16-show-adaptative-segue-error.markdown absPath of file >>> MarkdownRemark"}}}});
//# sourceMappingURL=path---show-adaptative-segue-error-719920294070f8c6803d.js.map